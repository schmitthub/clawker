# Test security options flag (--security-opt)
# Verifies: Security options are passed to container

# Register cleanup
defer clawker container rm --force --agent secopt-$RANDOM_STRING

# Create container with security option
exec clawker container create --agent secopt-$RANDOM_STRING --security-opt no-new-privileges alpine:latest sleep 3600

# Verify security option via inspect
exec clawker container inspect --format '{{json .HostConfig.SecurityOpt}}' --agent secopt-$RANDOM_STRING
stdout 'no-new-privileges'

-- clawker.yaml --
version: "1"

build:
  image: "alpine:latest"

security:
  firewall:
    enable: false
