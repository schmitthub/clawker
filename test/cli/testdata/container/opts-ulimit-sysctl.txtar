# Test ulimit, sysctl, and annotation flags
# Verifies: --ulimit, --sysctl, --annotation flags are supported

# Test --ulimit flag - verify nofile limits inside container
exec clawker container run --rm --ulimit nofile=1024:2048 alpine:latest sh -c 'ulimit -n'
stdout '1024'

# Test --sysctl flag
exec clawker container run --rm --sysctl net.ipv4.ip_forward=1 alpine:latest sysctl net.ipv4.ip_forward
stdout 'net.ipv4.ip_forward = 1'

# Test --annotation flag via create + inspect
defer clawker container rm --force --agent ann-$RANDOM_STRING
exec clawker container create --agent ann-$RANDOM_STRING --annotation mykey=myvalue alpine:latest sleep 3600
exec clawker container inspect --format '{{json .HostConfig.Annotations}}' --agent ann-$RANDOM_STRING
stdout 'mykey'
stdout 'myvalue'

-- clawker.yaml --
version: "1"

build:
  image: "alpine:latest"

security:
  firewall:
    enable: false
