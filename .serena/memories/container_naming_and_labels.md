# Container Naming and Labels System

## Naming Convention

### Container Names

Format: `clawker.project.agent`

- Example: `clawker.myapp.ralph`, `clawker.backend.worker-1`
- Generated by: `engine.ContainerName(project, agent) string`
- Parsed by: `engine.ParseContainerName(name) (project, agent string, ok bool)`

### Volume Names

Format: `clawker.project.agent-purpose`

- Purposes: `workspace`, `config`, `history`
- Example: `clawker.myapp.ralph-workspace`
- Generated by: `engine.VolumeName(project, agent, purpose) string`

### Random Agent Names

When `--agent` flag not provided:

- Generated by: `engine.GenerateRandomName() string`
- Format: adjective-noun (e.g., "clever-fox", "swift-panda")
- Uses predefined lists in `internal/engine/names.go`

## Docker Labels

All clawker-managed resources use `com.clawker.*` labels:

### Container Labels

| Constant | Label Key | Example Value |
|----------|-----------|---------------|
| `LabelManaged` | `com.clawker.managed` | `true` |
| `LabelProject` | `com.clawker.project` | `myapp` |
| `LabelAgent` | `com.clawker.agent` | `ralph` |
| `LabelVersion` | `com.clawker.version` | `1.0.0` |
| `LabelImage` | `com.clawker.image` | `clawker-myapp:dev` |
| `LabelWorkdir` | `com.clawker.workdir` | `/Users/dev/myapp` |
| `LabelCreated` | `com.clawker.created` | RFC3339 timestamp |

### Volume Labels

| Constant | Label Key | Example Value |
|----------|-----------|---------------|
| `LabelManaged` | `com.clawker.managed` | `true` |
| `LabelProject` | `com.clawker.project` | `myapp` |
| `LabelAgent` | `com.clawker.agent` | `ralph` |
| `LabelPurpose` | `com.clawker.purpose` | `workspace` |

## Helper Functions (internal/engine/labels.go)

```go
// Create labels for new resources
ContainerLabels(project, agent, version, image, workdir string) map[string]string
VolumeLabels(project, agent, purpose string) map[string]string

// Docker filter args for listing
ClawkerFilter() filters.Args           // all clawker resources
ProjectFilter(project string) filters.Args  // specific project
AgentFilter(project, agent string) filters.Args  // specific agent
```

## Listing Containers (internal/engine/client.go)

```go
// ClawkerContainer holds parsed container info
type ClawkerContainer struct {
    ID, Name, Project, Agent, Image, Workdir, Status string
    Created int64
}

// Listing methods
ListClawkerContainers(includeAll bool) ([]ClawkerContainer, error)
ListClawkerContainersByProject(project string, includeAll bool) ([]ClawkerContainer, error)
RemoveContainerWithVolumes(containerID string, force bool) error
```

## Usage Pattern

Commands that work with agents follow this pattern:

1. If `--agent` specified: use `ContainerName(project, agent)` directly
2. If no `--agent`: call `ListClawkerContainersByProject(project, ...)`
   - If 0 containers: error with guidance
   - If 1 container: use it
   - If >1 containers: error asking user to specify `--agent`
