# Docker CLI Testing Infrastructure and Organization

> Generated by codebase-scanner for docker/cli testing analysis

## Repository Summary

```
Name: docker/cli
Primary Language: Go (~85%)
Secondary Languages: Bash (~10%), C++ (~5%)
Testing Framework: Go standard testing + gotest.tools/v3
Organization Pattern: By-layer (with resource-based command structure)
Estimated Size: ~200+ test files, ~150 command packages
Test Coverage: Unit + E2E testing tiers with CI/CD integration
```

## Testing Architecture Overview

The Docker CLI employs a comprehensive, multi-tiered testing strategy combining unit tests for individual command components with end-to-end tests against real Docker daemons. Testing is heavily containerized, allowing consistent testing across platforms.

### Testing Tiers

#### 1. Unit Testing Tier
- **Scope**: Command logic, flag parsing, error handling, data transformation
- **Framework**: Go standard `testing` package + `gotest.tools/v3`
- **Mocking**: `test.NewFakeCli()` pattern with injectable mock clients
- **Coverage**: Error paths, edge cases, flag validation
- **Location**: Colocated with source: `cli/command/<resource>/<command>_test.go`

#### 2. End-to-End Testing Tier
- **Scope**: Full command execution against real Docker daemon
- **Framework**: `gotest.tools/v3/icmd` for command execution
- **Coverage**: Success paths, flag integration, output format validation
- **Location**: Mirrored structure: `e2e/<resource>/<command>_test.go`
- **Frequency**: Limited (one primary test per command, ~3-5 for complex commands)

#### 3. Integration Testing Elements
- **Environment setup**: `internal/test/environment/testenv.go`
- **Daemon capability detection**: Platform-specific skipping
- **Connection helper testing**: SSH connection helper E2E variant

---

## Directory Map

### Root Testing Directories

```
repository-root/
├── e2e/                           # End-to-end test suite
│   ├── container/                 # Container command tests
│   │   ├── main_test.go          # Environment setup via TestMain
│   │   ├── run_test.go           # docker run command tests
│   │   ├── attach_test.go        # docker attach tests
│   │   ├── kill_test.go          # etc.
│   │   └── testdata/             # Fixtures and golden files
│   ├── image/                     # Image command E2E tests
│   ├── context/                   # Context command E2E tests
│   ├── plugin/                    # Plugin command E2E tests
│   ├── stack/                     # Stack/Compose E2E tests
│   ├── system/                    # System command E2E tests
│   ├── global/                    # Global flag/behavior tests
│   ├── cli-plugins/              # CLI plugin system tests
│   ├── registry/                  # Registry interaction tests
│   ├── internal/
│   │   └── fixtures/fixtures.go   # Shared test fixtures (images, config helpers)
│   ├── testutils/                 # E2E utilities
│   │   ├── plugins.go            # Plugin setup helpers
│   │   └── plugins/basic.go      # Embedded test plugin
│   ├── testdata/                  # Global test data
│   │   ├── Dockerfile.gencerts   # Certificate generation for TLS tests
│   │   └── [various test artifacts]
│   ├── compose-env.yaml          # Docker Compose for E2E setup
│   └── compose-env.connhelper-ssh.yaml  # SSH connection helper variant

├── internal/test/                 # Unit test infrastructure (package-level)
│   ├── doc.go                    # Package documentation
│   ├── cli.go                    # FakeCli implementation
│   ├── cmd.go                    # Command execution helpers
│   ├── writer.go                 # Output stream writers
│   ├── randomid.go               # Random ID generation
│   ├── strings.go                # String utilities
│   ├── environment/
│   │   └── testenv.go            # Environment setup and platform checks
│   │       - Setup(): Initialize test environment
│   │       - RemoteDaemon(): Check if daemon is remote
│   │       - SkipIfDaemonNotLinux(): Skip non-Linux daemon tests
│   │       - SkipIfNotExperimentalDaemon(): Skip non-experimental tests
│   │       - DefaultPollSettings: Timing utilities
│   ├── builders/                 # Test object builders (fluent interface)
│   │   ├── doc.go               # Builder pattern documentation
│   │   ├── container.go         # Container builder
│   │   ├── service.go           # Service builder
│   │   ├── network.go           # Network builder
│   │   ├── volume.go            # Volume builder
│   │   ├── swarm.go             # Swarm builder
│   │   ├── config.go            # Config builder
│   │   ├── secret.go            # Secret builder
│   │   ├── task.go              # Task builder
│   │   └── node.go              # Node builder
│   ├── network/
│   │   └── client.go            # Network mock client
│   └── output/
│       └── output.go            # Output capture utilities

├── cli/command/                   # Command source code with colocated tests
│   ├── container/
│   │   ├── run.go               # Container run command
│   │   ├── run_test.go          # Unit tests for run command
│   │   ├── attach_test.go
│   │   ├── testdata/            # Fixtures for container tests
│   │   └── main_test.go (in e2e/)
│   ├── image/
│   │   ├── build.go
│   │   ├── build_test.go
│   │   ├── build/
│   │   │   ├── context.go
│   │   │   ├── context_test.go
│   │   │   └── internal/        # Build context utilities
│   │   └── testdata/
│   ├── service/
│   │   ├── create.go
│   │   ├── create_test.go
│   │   └── [15+ other service commands with tests]
│   ├── stack/
│   │   ├── deploy.go
│   │   ├── deploy_test.go
│   │   └── [stack-related tests]
│   ├── formatter/               # Output formatting
│   │   ├── formatter.go
│   │   ├── formatter_test.go
│   │   ├── container_test.go
│   │   ├── image_test.go
│   │   └── [format-specific tests]
│   ├── cli_test.go             # CLI root tests
│   └── [40+ command directories, each with *_test.go files]

├── dockerfiles/                   # Test infrastructure Docker images
│   ├── Dockerfile.dev            # Development container with test tools
│   ├── Dockerfile.lint           # Linting environment
│   ├── Dockerfile.shellcheck     # Shell script validation
│   ├── Dockerfile.vendor         # Vendor management
│   └── Dockerfile.authors        # Author file generation

├── Makefile                       # Host-based test targets
│   ├── test / test-unit         # Run unit tests
│   ├── test-coverage            # Generate coverage reports
│   ├── lint                     # Run linters
│   ├── shellcheck               # Validate shell scripts
│   └── fmt                      # Format code

├── docker.Makefile               # Docker-based test execution
│   ├── test-unit                # Docker buildx bake test
│   ├── test-coverage            # Docker buildx bake test-coverage
│   ├── test-e2e                 # Full E2E suite
│   ├── test-e2e-local           # Local daemon E2E tests
│   └── test-e2e-connhelper-ssh  # SSH connection helper E2E tests

├── docker-bake.hcl               # BuildKit configuration for testing
│   ├── target "test"            # Unit test execution target
│   ├── target "test-coverage"   # Coverage target
│   ├── target "e2e-image"       # E2E test image building
│   ├── target "e2e-gencerts"    # Certificate generation for TLS
│   ├── target "lint"            # Linting
│   └── target "shellcheck"      # Shell validation

├── .github/workflows/
│   ├── test.yml                 # Unit test CI pipeline
│   │   ├── Container job: docker buildx bake test-coverage
│   │   └── Host job: macOS native testing (arm64, Intel)
│   ├── e2e.yml                  # E2E test CI pipeline
│   │   ├── Multiple engine versions: rc, 29, 28, 25
│   │   ├── Multiple base images: alpine, debian
│   │   └── Multiple connection helpers: local, SSH
│   ├── validate.yml             # Code quality validation
│   └── codeql.yml               # Security scanning

├── scripts/test/                  # Test execution scripts
│   └── e2e/
│       ├── run                  # Main E2E test runner
│       ├── entry                # Container entry point
│       ├── wrapper              # Test wrapper
│       ├── wait-on-daemon       # Daemon readiness check
│       └── load-image           # Test image loader

├── TESTING.md                     # Testing guidelines and conventions

└── go.mod / vendor.mod           # Go module dependencies
```

---

## Test File Organization and Naming Conventions

### Unit Test Files
**Location Pattern**: `cli/command/<resource>/<command>_test.go`

**Examples**:
- `cli/command/container/run_test.go` - Tests for `docker run`
- `cli/command/image/build_test.go` - Tests for `docker build`
- `cli/command/service/create_test.go` - Tests for `docker service create`
- `cli/command/formatter/container_test.go` - Container formatter tests

**Naming Convention**:
```
Test<FunctionName><TestCase>
```

**Examples**:
```go
func TestRunValidateFlags(t *testing.T)
func TestRunLabel(t *testing.T)
func TestRunAttach(t *testing.T)
func TestRunInvalidEntrypointWithAutoremove(t *testing.T)
```

**Table-Driven Tests**:
```go
func TestRunValidateFlags(t *testing.T) {
    for _, tc := range []struct {
        name        string
        args        []string
        expectedErr string
    }{
        {
            name:        "with conflicting --attach, --detach",
            args:        []string{"--attach", "stdin", "--detach", "myimage"},
            expectedErr: "conflicting options: cannot specify both --attach and --detach",
        },
    } {
        t.Run(tc.name, func(t *testing.T) {
            // test implementation
        })
    }
}
```

### End-to-End Test Files
**Location Pattern**: `e2e/<resource>/<command>_test.go`

**Structure**:
- `e2e/<resource>/main_test.go` - Environment setup via `TestMain()`
- `e2e/<resource>/<command>_test.go` - Test cases

**Examples**:
- `e2e/container/main_test.go` + `e2e/container/run_test.go`
- `e2e/image/push_test.go`
- `e2e/context/context_test.go`

**Naming Convention**:
```
Test<CommandBasename>[<TestCase>]
```

**Examples**:
```go
func TestRunAttachedFromRemoteImageAndRemove(t *testing.T)
func TestRunAttach(t *testing.T)
func TestRunInvalidEntrypointWithAutoremove(t *testing.T)
```

### Testdata Organization
Each command package typically includes a `testdata/` directory:

**Patterns**:
- `cli/command/container/testdata/` - Container command fixtures
- `cli/command/image/testdata/` - Image command fixtures
- `e2e/container/testdata/` - E2E container fixtures and golden files

**File Types**:
- `.golden` - Golden files for output comparison
- `Dockerfile` - Test Docker images
- Compose files - Multi-container test scenarios
- Config files - Sample configurations

---

## Testing Infrastructure Components

### 1. FakeCli Pattern (core unit testing approach)

**Location**: `internal/test/cli.go`

**Key Type**:
```go
type FakeCli struct {
    // ... implementation
}

func NewFakeCli(client *fakeClient) *FakeCli
```

**Provided Methods**:
- `SetIn()`, `SetOut()`, `SetErr()` - Control I/O streams
- `SetConfigFile()`, `SetCurrentContext()` - Manage configuration
- `SetContextStore()`, `SetDockerEndpoint()` - Set context/endpoint
- `Client()` - Return mocked Docker client
- `OutBuffer()`, `ErrBuffer()` - Capture output
- `ResetOutputBuffers()` - Clear captured output

**Usage Pattern**:
```go
func TestRunLabel(t *testing.T) {
    fakeCLI := test.NewFakeCli(&fakeClient{
        createContainerFunc: func(options client.ContainerCreateOptions) (client.ContainerCreateResult, error) {
            return client.ContainerCreateResult{ID: "id"}, nil
        },
        Version: client.MaxAPIVersion,
    })
    cmd := newRunCommand(fakeCLI)
    cmd.SetArgs([]string{"--detach=true", "--label", "foo", "busybox"})
    assert.NilError(t, cmd.Execute())
}
```

### 2. Test Builders (fluent test object creation)

**Location**: `internal/test/builders/`

**Pattern**: Fluent builder functions for creating complex test objects

**Example - Container Builder**:
```go
// cli/command/container/formatter_test.go usage
func Container(name string, builders ...func(c *container.Summary)) *container.Summary

func WithLabel(key, value string) func(*container.Summary)
func WithName(name string) func(*container.Summary)
func WithPort(privatePort, publicPort uint16) func(*container.Summary)
```

**Available Builders**:
- `builders.Container()` - Create test container
- `builders.Service()` - Create test service
- `builders.Network()` - Create test network
- `builders.Volume()` - Create test volume
- `builders.Task()` - Create test task
- `builders.Node()` - Create test node
- `builders.Config()` - Create test config
- `builders.Secret()` - Create test secret

### 3. Environment Setup and Platform Checks

**Location**: `internal/test/environment/testenv.go`

**Key Functions**:
```go
func Setup() error                          // Initialize test environment
func RemoteDaemon() bool                    // Check if remote daemon
func SkipPluginTests() bool                 // Check plugin skip flag
func SkipIfNotExperimentalDaemon(t *testing.T)    // Skip non-experimental
func SkipIfDaemonNotLinux(t *testing.T)          // Skip non-Linux
func SkipIfCgroupNamespacesNotSupported(t *testing.T)  // Namespace check
func SkipIfNotPlatform(t *testing.T, platform string)  // Platform check
```

**E2E Entry Point**:
```go
// e2e/container/main_test.go
func TestMain(m *testing.M) {
    if err := environment.Setup(); err != nil {
        fmt.Println(err.Error())
        os.Exit(3)
    }
    os.Exit(m.Run())
}
```

### 4. E2E Test Fixtures and Helpers

**Location**: `e2e/internal/fixtures/fixtures.go`

**Key Functions**:
```go
func SetupConfigFile(t *testing.T) fs.Dir         // Create test config
func WithConfig(dir string) func(cmd *icmd.Cmd)   // Add config to command
func WithHome(path string) func(*icmd.Cmd)        // Set HOME env
```

**Predefined Images**:
```go
const (
    AlpineImage = "registry:5000/alpine:frozen"
    BusyboxImage = "registry:5000/busybox:frozen"
)
```

**Registry Access**:
- E2E tests use local registry at `registry:5000`
- Loaded by test setup scripts
- Supports image pulling/pushing without remote registry

### 5. Test Utilities and Assertions

**Key Libraries**:
- `gotest.tools/v3/assert` - Assertion library (preferred)
- `gotest.tools/v3/icmd` - Command execution
- `gotest.tools/v3/golden` - Golden file comparisons
- `gotest.tools/v3/poll` - Polling for async operations
- `gotest.tools/v3/skip` - Test skipping utilities
- `gotest.tools/v3/fs` - File system utilities

**Assertion Examples**:
```go
assert.NilError(t, err)                           // Error must be nil
assert.Check(t, is.Equal(expected, actual))       // Value equality
assert.Check(t, is.ErrorContains(err, "message")) // Error message check
golden.Assert(t, result.Stderr(), "file.golden")  // Compare with golden file
```

---

## Build and Execution Infrastructure

### Makefile Targets (Local Development)

**File**: `Makefile`

```makefile
make test               # Run all tests (alias for test-unit)
make test-unit         # Run unit tests via gotestsum
                       # Output: GOTESTSUM_FORMAT={dots|short|standard-quiet|short-verbose|standard-verbose}
make test-coverage     # Generate coverage report to build/coverage/coverage.txt
make lint              # Run golangci-lint
make shellcheck        # Validate shell scripts in scripts/ contrib/
make fmt               # Format code with gofumpt (or gofmt -s)
make clean             # Remove build artifacts
```

**Test Execution Details**:
```bash
# Unit tests (gotestsum wrapper)
gotestsum -- $(go list ./... | grep -vE '/vendor/|/e2e/|/cmd/docker-trust')

# Coverage generation
mkdir -p build/coverage
gotestsum -- $(go list ./... | grep -vE '/vendor/|/e2e/|/cmd/docker-trust') \
    -coverprofile=build/coverage/coverage.txt
```

### Docker-Based Test Execution (docker.Makefile)

**File**: `docker.Makefile`

```makefile
make test-unit                    # Run docker buildx bake test
make test-coverage                # Run docker buildx bake test-coverage
make test-e2e                     # Run all E2E tests (local + SSH)
make test-e2e-local               # Run local daemon E2E tests
make test-e2e-connhelper-ssh      # Run SSH connection helper E2E tests
```

**Docker Image Names**:
- `docker-cli-dev` - Development container with test tools
- `docker-cli-e2e` - E2E test runner image

**Environment Variables**:
```
TESTFLAGS=          # Additional flags to pass to go test
TESTDIRS=           # Override default test directories
ENGINE_VERSION=     # Docker engine version for E2E (rc, 29, 28, 25)
BASE_VARIANT=       # Base image variant (alpine, debian)
TEST_CONNHELPER=    # Connection helper type (ssh for E2E)
```

### Docker Buildx Bake Configuration (docker-bake.hcl)

**Test Targets**:

```hcl
target "test" {
    # Unit test execution
    target = "test"
    output = ["type=cacheonly"]
}

target "test-coverage" {
    # Coverage report generation
    target = "test-coverage"
    output = ["build/coverage"]
}

target "e2e-image" {
    # E2E test image building
    target = "e2e"
    output = ["type=docker"]
    tags = ["${IMAGE_NAME}"]
}

target "e2e-gencerts" {
    # Generate TLS certificates for E2E tests
    dockerfile = "./e2e/testdata/Dockerfile.gencerts"
    output = ["./e2e/testdata"]
}
```

### Development Container (Dockerfile.dev)

**Based On**: `golang:1.25.6-alpine3.22`

**Installed Tools**:
- `gotestsum v1.13.0` - Test output formatter
- `gofumpt v0.7.0` - Code formatter
- `buildx 0.29.1` - Docker buildx CLI plugin
- `goversioninfo v1.5.0` - Windows version info tool
- Standard utilities: bash, git, jq, curl, etc.

**Environment**:
```dockerfile
ENV DISABLE_WARN_OUTSIDE_CONTAINER=1
ENV PATH=$PATH:/go/src/github.com/docker/cli/build
ENV GO111MODULE=auto
WORKDIR /go/src/github.com/docker/cli
```

---

## Continuous Integration and CD

### CI/CD Workflows (.github/workflows/)

#### 1. Unit Test Workflow (test.yml)

**Container Job** (`ubuntu-24.04`):
- Executes: `docker buildx bake test-coverage`
- Generates: Coverage report
- Uploads to: Codecov with token

**Host Job** (macOS):
- Runs on: macOS 14 (arm64), macOS 15 Intel, macOS 15 (arm64)
- Skipped: Windows (failing tests)
- Execution:
  ```bash
  ln -s vendor.mod go.mod
  ln -s vendor.sum go.sum
  go test -coverprofile=/tmp/coverage.txt $(go list ./... | grep -vE '^github.com/docker/cli/e2e/')
  ```

#### 2. E2E Test Workflow (e2e.yml)

**Matrix Strategy**:
- **Engine Versions**: rc (latest), 29, 28, 25 (LTS)
- **Base Images**: alpine, debian
- **Connection Helpers**: local, connhelper-ssh

**Execution**:
```bash
make -f docker.Makefile test-e2e-${{ matrix.target }}
```

**Coverage Output**: `build/coverage/coverage.txt`

#### 3. Additional Workflows

- **validate.yml** - Code quality and validation
- **codeql.yml** - Security scanning
- **validate-pr.yml** - Pull request validation

### Test Execution Scripts (scripts/test/)

**E2E Test Runner Chain**:
1. `scripts/test/e2e/run` - Main orchestrator
2. `scripts/test/e2e/entry` - Container entry point
3. `scripts/test/e2e/wrapper` - Test execution wrapper
4. `scripts/test/e2e/wait-on-daemon` - Daemon readiness check
5. `scripts/test/e2e/load-image` - Load test fixtures

---

## Testing Dependencies and Libraries

### Core Testing Libraries (go.mod)

**Assertion & Utilities**:
```
gotest.tools/v3 v3.5.2  # Assertions, icmd, golden, poll, skip, fs
```

**Specialized Tools**:
```
github.com/creack/pty v1.1.24         # Terminal emulation for interactive tests
github.com/google/go-cmp v0.7.0       # Deep equality comparisons
github.com/moby/moby/api v1.53.0-rc.1 # Docker API types
github.com/moby/moby/client v0.2.2-rc.1 # Docker client
```

**Command Execution**:
- `gotestyourself/icmd` (via gotest.tools) - Command execution and assertions

### Development Tools (Dockerfile.dev)

**Test Runners**:
- `gotestsum v1.13.0` - Go test output formatter and aggregator

**Code Formatters**:
- `gofumpt v0.7.0` - Go code formatter (preferred over gofmt)

**Validation Tools**:
- `golangci-lint` - Multi-linter (configured in .golangci.yml)
- `shellcheck` - Shell script validation

---

## Testing Patterns and Best Practices

### 1. Unit Test Structure

**Standard Pattern**:
```go
func TestCommandFunctionality(t *testing.T) {
    // Setup: Create FakeCli with mock responses
    fakeCLI := test.NewFakeCli(&fakeClient{
        createContainerFunc: func(options client.ContainerCreateOptions) (client.ContainerCreateResult, error) {
            return client.ContainerCreateResult{ID: "id"}, nil
        },
    })

    // Execute: Create command and set arguments
    cmd := newRunCommand(fakeCLI)
    cmd.SetArgs([]string{"--flag", "value", "image"})
    err := cmd.Execute()

    // Assert: Check results
    assert.NilError(t, err)
    assert.Check(t, strings.Contains(fakeCLI.OutBuffer().String(), "expected"))
}
```

### 2. E2E Test Structure

**Standard Pattern**:
```go
func TestCommandName(t *testing.T) {
    skip.If(t, environment.RemoteDaemon())  // Skip remote daemon
    environment.SkipIfDaemonNotLinux(t)      // Skip non-Linux

    result := icmd.RunCommand("docker", "command", "--flag", "value")
    result.Assert(t, icmd.Success)

    assert.Check(t, is.Contains(result.Stdout(), "expected output"))
    golden.Assert(t, result.Stderr(), "expected.golden")
}
```

### 3. Builder Pattern Usage

**Pattern**:
```go
func TestContainerFormatting(t *testing.T) {
    // Use builder to create test container
    container := builders.Container("test",
        builders.WithLabel("key", "value"),
        builders.WithPort(8080, 9090),
        builders.WithName("alias"),
    )

    // Use in formatter test
    actual := formatContainer(container)
    assert.Check(t, is.Equal(actual, expected))
}
```

### 4. Table-Driven Test Pattern

**Pattern**:
```go
func TestValidation(t *testing.T) {
    tests := []struct {
        name        string
        args        []string
        expectedErr string
    }{
        {"valid args", []string{"--flag", "value", "image"}, ""},
        {"invalid flag", []string{"--invalid", "image"}, "unknown flag"},
        {"missing image", []string{"--flag", "value"}, "requires image"},
    }

    for _, tc := range tests {
        t.Run(tc.name, func(t *testing.T) {
            cmd := newCommand(test.NewFakeCli(&fakeClient{}))
            cmd.SetArgs(tc.args)
            err := cmd.Execute()

            if tc.expectedErr != "" {
                assert.Check(t, is.ErrorContains(err, tc.expectedErr))
            } else {
                assert.NilError(t, err)
            }
        })
    }
}
```

### 5. Mock Client Pattern

**Pattern**:
```go
type fakeClient struct {
    // Embed API methods
    createContainerFunc func(options client.ContainerCreateOptions) (client.ContainerCreateResult, error)
    containerListFunc   func(ctx context.Context, options client.ContainerListOptions) ([]container.Summary, error)
}

func (fc *fakeClient) ContainerCreate(ctx context.Context, options client.ContainerCreateOptions) (client.ContainerCreateResult, error) {
    if fc.createContainerFunc != nil {
        return fc.createContainerFunc(options)
    }
    return client.ContainerCreateResult{}, nil
}
```

---

## Testing Coverage and Quality Metrics

### Coverage Tracking
- **Tool**: Codecov integration
- **Coverage Report**: `build/coverage/coverage.txt`
- **Excluded from Coverage**: `vendor/`, `e2e/`, `cmd/docker-trust`
- **CI Integration**: Uploaded to codecov after unit tests and E2E tests

### Code Quality Tools
- **Linting**: golangci-lint (.golangci.yml)
- **Formatting**: gofumpt (Go 1.24 language version)
- **Shell Scripts**: shellcheck on scripts/ and contrib/
- **Security**: CodeQL analysis

---

## Notable Testing Characteristics

### 1. Extensive Mocking
- Nearly every command has unit tests with mocked clients
- FakeCli pattern enables comprehensive testing without real daemon
- ~150+ unit test files colocated with implementation

### 2. E2E Coverage is Targeted
- One primary success case per command (e2g., `docker run`)
- ~3-5 tests for complex/critical commands
- Error cases covered at unit test level
- E2E focuses on integration, not comprehensive error testing

### 3. Multi-Tier Testing Approach
```
Unit Tests (fast, comprehensive)  ← Error paths, edge cases
    ↓
E2E Tests (slower, integration)   ← Success paths, real daemon
    ↓
CI/CD (multiple platforms/engines) ← Regression detection
```

### 4. Platform-Aware Testing
- Tests skip automatically based on:
  - Daemon OS (Linux vs Windows)
  - Experimental features
  - Plugin support
  - Remote vs local daemon
  - Cgroup namespace support

### 5. Containerized Testing Infrastructure
- All tests run in Docker containers
- Consistent environment across CI/CD
- Multi-platform testing (alpine, debian)
- Multiple engine versions tested (rc, 29, 28, 25)

### 6. Golden File Comparisons
- E2E tests use `.golden` files for output validation
- Helps detect unintended formatting changes
- Exists in: `e2e/<resource>/testdata/`

---

## Key Entry Points for Test Execution

### For Developers
```bash
# Quick unit test (local)
make test-unit

# All unit tests with coverage (Docker-based)
make -f docker.Makefile test-coverage

# Interactive development
make -f docker.Makefile dev

# E2E against running daemon
make -f docker.Makefile test-e2e
```

### For CI/CD
```bash
# Container unit tests
docker buildx bake test-coverage

# E2E tests with multiple configs
make -f docker.Makefile test-e2e-local
make -f docker.Makefile test-e2e-connhelper-ssh

# Validation
docker buildx bake lint
docker buildx bake shellcheck
```

---

## Summary Statistics

| Metric | Value |
|--------|-------|
| Unit Test Files | 150+ |
| E2E Test Directories | 12 |
| Command Packages with Tests | 40+ |
| Test Helper Modules | 6 (builders, environment, network, output, etc.) |
| Total Testdata Directories | 30+ |
| CI/CD Workflow Files | 6 |
| Test Execution Scripts | 5 |
| Primary Testing Framework | gotest.tools/v3 |
| Supported Go Version | 1.24+ (1.25.6 in CI) |
| Docker Engine Versions Tested | 4 (rc, 29, 28, 25) |
| Base Images Tested | 2 (alpine, debian) |
