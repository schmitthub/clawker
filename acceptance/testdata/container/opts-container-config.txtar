# Test container configuration flags
# Verifies: --group-add, --cidfile, --cgroup-parent, --runtime, --isolation flags work

# Test --group-add flag - verify group is added inside container
exec clawker container run --rm --group-add audio alpine:latest id
stdout 'audio'

# Test --runtime flag (runc is the default)
exec clawker container run --rm --runtime runc alpine:latest echo runtime-test
stdout 'runtime-test'

# Test --cgroup-parent flag via create + inspect
defer clawker container rm --force --agent cg-$RANDOM_STRING
exec clawker container create --agent cg-$RANDOM_STRING --cgroup-parent /custom alpine:latest sleep 3600
exec clawker container inspect --format '{{.HostConfig.CgroupParent}}' --agent cg-$RANDOM_STRING
stdout '/custom'

-- clawker.yaml --
version: "1"

build:
  image: "alpine:latest"

security:
  firewall:
    enable: false
