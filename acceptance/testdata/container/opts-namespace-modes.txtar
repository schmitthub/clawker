# Test namespace mode flags (--pid, --uts, --userns, --cgroupns, --ipc)
# Verifies: Docker CLI namespace isolation flags are accepted

# Test --pid host flag - can see host PIDs
exec clawker container run --rm --pid host alpine:latest echo pid-test
stdout 'pid-test'

# Test --ipc host flag
exec clawker container run --rm --ipc host alpine:latest echo ipc-test
stdout 'ipc-test'

# Test namespace modes via create + inspect
defer clawker container rm --force --agent ns-$RANDOM_STRING
exec clawker container create --agent ns-$RANDOM_STRING --pid host --ipc host alpine:latest sleep 3600
exec clawker container inspect --format '{{.HostConfig.PidMode}}' --agent ns-$RANDOM_STRING
stdout 'host'
exec clawker container inspect --format '{{.HostConfig.IpcMode}}' --agent ns-$RANDOM_STRING
stdout 'host'

-- clawker.yaml --
version: "1"

build:
  image: "alpine:latest"

security:
  firewall:
    enable: false
